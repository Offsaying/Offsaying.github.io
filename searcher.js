let SearchResult = '[{"title": "Infi2 Pic", "path": "Infi2_Pic.html", "text": "Infi2PicHithisisallmynotesinpictureswhenIwasstudyinginInfi2IhavenotmakeeachofthemintowebsitesdirectlybecausetheyaretoobigsoIputthemintoatableandyoucaneasilycheckitinthefollowingtable"}, {"title": "Alg Lec 15", "path": "Alg_Lec_15.html", "text": "AlgLec15fVVdimVnstffVxrightarrowVdimVninftystchiffVVdimVnstfsplitscompletelyoverKmathbbKKexistsanorderedbasisBofVstfBJn11Jn22JnrrfBbeginbmatrixJn1lambda1Jn2lambda2ddotsJnrlambdarendbmatrixfBJn11Jn22JnrrThisistheJordancanonicalformJCFWithrrrNn1nrNn1nrninmathbbNn1ldotsnrinmathbbNn1cdotsnrnNn1nrNn1nrnThescalars1rlambda1ldotslambdar1raretheeigenvaluesmaybesomerepetitionsundersetundersettextmaybesomerepetitionsdownarroweigenvaluesmaybesomerepetitionseigenvaluesoffffJm11MmKmsizeNeigenvalueKJmmubeginbmatrixmu1muddotsddots1muendbmatrixinMmmathbbKundersetundersettextsizedownarrowminmathbbNundersetundersettexteigenvaluedownarrowmuinmathbbKJm11MmKsizemNeigenvalueKJordanblockofsizemandeigenvaluemuTheJordancanonicalformoffffisuniquelydeterminedbyfffuptoapermutationoftheJordanblocksnumberofblocksInfactthenumberofblocksboxednumberofblocksnumberofblocksinJofsizemandeigenvaluemuisrfIm12rfImrfIm1rfmuIm12rfmuImrfmuIm1rfIm12rfImrfIm1Examplefx13x22chifx13x22fx13x22Theeigenvaluesare12ExampleSupposefVVfVxrightarrowVfVVhasoneboxedoneoneblockofeigenvaluelambdasize3fB100100doesnothaveaseigenvaluefBbeginbmatrixlambda100lambda100lambdatextdoesnothavelambdatextaseigenvalueendbmatrixfB001001doesnothaveaseigenvalueBv1v2Bv1v2ldotsBv1v2fv1v1f1v10fv1lambdav1xrightarrowflambda1v10fv1v1f1v10fv2v1v2fv2v1f2v20fv2v1lambdav2xrightarrowflambdav2v1xrightarrowflambda2v20fv2v1v2fv2v1f2v20fv3v2v3fv3v2f2v3v1f3v30fv3v2lambdav3xrightarrowflambdav3v2xrightarrowflambda2v3v1xrightarrowflambda3v30fv3v2v3fv3v2f2v3v1f3v30Thusfvivi1vifivi0fvivi1lambdavixrightarrowflambdaivi0fvivi1vifivi0kerfv1kerflambdaleftlanglev1rightranglekerfv1kerf2v1v2kerflambda2leftlanglev1v2rightranglekerf2v1v2kerf3v1v2v3kerflambda3leftlanglev1v2v3rightranglekerf3v1v2v3fB010001000BIflambdaBbeginbmatrix010001000BlambdaIendbmatrixfB000100010BIfB2001000000BI2flambdaB2beginbmatrix001000000BlambdaI2endbmatrixfB2000000100BI2fB3000000000BI3flambda3Bbeginbmatrix000000000BlambdaI3endbmatrixfB3000000000BI3Letw3kerf3w3inkerflambda3w3kerf3w2fw3w2flambdaw3w2fw3w1fw2w1flambdaw2w1fw2fw1f2w2f3w30flambdaw1flambda2w2flambda3w30fw1f2w2f3w30fw1w1fw1lambdaw1fw1w1fw2w1w2fw2w1lambdaw2fw2w1w2fw3w2w3fw3w2lambdaw3fw3w2w3observethatLetfVVfVxrightarrowVfVVwithonlyoneboxedoneoneblockofeigenvalueboxedlambdaandletnboxednnbethesizeexistsabasisBBBthattakeffftoJCFBw1w2wnBw1w2ldotswnldotsBw1w2wn0kerfkerf2kerfn1kerfn0leqkerflambdaleqkerflambda2leqcdotsleqkerflambdan1leqkerflambdan0kerfkerf2kerfn1kerfnfBn000000000nnBIiflambdaBnbeginbmatrix00cdots000cdots0vdotsvdotsddotsvdots00cdots0ntimesnBlambdaIiendbmatrixfBn000000000nnBIiLetwnkerfnwninkerflambdanwnkerfnwn1fwnwn1flambdawnwn1fwnwn2fwn1wn2flambdawn1wn2fwn1vdotsw1w1cdotsw1LetAMnKAinMnmathbbKAMnKwithAchiAAsplitscompletelyoverKmathbbKKexistsaninvertiblematrixCCCstCAC1JCAC1JCAC1JwithJJJasJCFThenumberofblocksofJJJwithlambdaandsizenisdeterminedbyAAADefinitionDefunderlinemathbfDefDefABMnKABinMnmathbbKABMnKaresimilarifCMnKexistsCinMnmathbbKCMnKinvertiblestCAC1BCAC1BCAC1BEverymatrixwithchisplitscompletelyissimilartoaJCFTwoJCFaresimilarLeftrightarrowtheyhavethesameblocksCorollaryCorollaryunderlinemathbfCorollaryCorollarytwomatricesinMnCMnmathbbCMnCaresimilarLeftrightarrowtheyhavethesameJCFExampleunderlinemathbfExampleExample1170110012402beginbmatrix1170110012402endbmatrix1001107112042similarwith1110110012302beginbmatrix1110110012302endbmatrix1001101112032111111beginbmatrix111111endbmatrix111111notsimilarwith1111beginbmatrix1111endbmatrix1111ProofunderlinemathbfProofProofLetABMnCABinMnmathbbCABMnCexistsaninvertiblematrixCDCDCDstCAC1JADBD1JBCAC1JADBD1JBCAC1JADBD1JBvdotsProblemProblemunderlinemathbfProblemProblemCountsimilarityclassesHowmanysimilarityclassesarethereofmatricesinMnCMnmathbbCMnCwithAx12x22chiAx12x22Ax12x22JJJisaJCFstx12x22chix12x22x12x22JJn11Jn22JbeginbmatrixJn1lambda1Jn2lambda2ddotsendbmatrixJJn11Jn22observeobservethatthelargestsizeofablockforlambdainJCFofAAAisequaltothemultiplicityof2lambda22rootofAmuAACyclicvectorsfVVvVfVxrightarrowVvinVfVVvVthefcyclicboxedfcyclicfcyclicsubspacegeneratedbyvvvisvfvfvf2vleftlanglevrightranglefleftlanglevfvf2vldotsrightranglevfvfvf2vWesaythatvvvisafcyclicboxedfcyclicfcyclicvectorifvfVleftlanglevrightranglefVvfVExampleExampleunderlinemathbfExampleExampleSupposefB1111fBbeginbmatrixlambda1lambda1lambda1ddotsddotslambda1lambdaendbmatrixfB1111Bv1vnBv1ldotsvnBv1vnvnvnvnisafcyclicboxedfcyclicfcyclicvectorfvnvnvn1fvnvn1becausefvnlambdavnvn1xrightarrowflambdavnvn1fvnvnvn1fvnvn1fvn1vn1vn2f2vnvn2becausefvn1lambdavn1vn2xrightarrowflambda2vnvn2fvn1vn1vn2f2vnvn2vdotsvnfvnfvnf2vnvnvn1vn2v1Vleftlanglevnrightranglefleftlanglevnfvnf2vnldotsrightrangleleftlanglevnvn1vn2ldotsv1rightrangleVvnfvnfvnf2vnvnvn1vn2v1V"}, {"title": "Alg B Ass 4", "path": "AlgB_Ass_4.html", "text": "AlgBAss4Problem1LetNandMbetwo6times6nilpotentmatricesoverafieldKmathbbKKaShowthatifNandMhavethesameminimalpolynomialandthesamenullitythenNandMaresimilarbProvethatthesameresultisfalsefor77nilpotentmatricesProofunderlinemathbfProofProofabecausetheyarenilpotentxrightarrowtheireigenvaluesare0andthepossiblesizeoftheJordanblockscorrespondingtothepartitionofn6becausemuarethesamexrightarrowtheyhavethesamemaximalblocksizebecausetheyhavethesamenullityxrightarrowtheyhavethesameJCFThusMNaresimilarMNaresimilarMNaresimilarbcounterexampleM7701010010100N7701010010010M7times7beginbmatrix01010010100endbmatrixN7times7beginbmatrix01010010010endbmatrixM7701010010100N7701010010010Problem2aFindtheJCFforthematrixA4100120073207612Abeginbmatrix4100120073207612endbmatrixA4177123600210002bFindaninvertiblematrixPPPsuchthatP1APP1APP1APisthatJordanmatrixProofunderlinemathbfProofProofaAAI2232chiAlambdabeginvmatrixAlambdaIendvmatrixlambda22lambda32AAI2232For2lambda22AI6100140073007610kerAIspan0001AlambdaIbeginbmatrix6100140073007610endbmatrixkerAlambdaIspanleftbeginbmatrix0001endbmatrixrightAI6177143600010000kerAIspan0001Algebraicmultiplicity2Geometricmultiplicity1AIv0001v0010AlambdaIvbeginbmatrix0001endbmatrixxrightarrowvbeginbmatrix0010endbmatrixAIv0001v0010For3lambda33AI1100110073507615kerAIspan1123AlambdaIbeginbmatrix1100110073507615endbmatrixkerAlambdaIspanleftbeginbmatrix1123endbmatrixrightAI1177113600510005kerAIspan1123Algebraicmultiplicity2Geometricmultiplicity1AIv1123vy1y2y13y11011AlambdaIvbeginbmatrix1123endbmatrixxrightarrowvbeginbmatrixy1y2y13y1endbmatrixxrightarrowbeginbmatrix1011endbmatrixAIv1123vy1y2y13y11011Ainbasis1123101100010010leftbeginbmatrix1123endbmatrixbeginbmatrix1011endbmatrixbeginbmatrix0001endbmatrixbeginbmatrix0010endbmatrixright1123101100010010hasJA3100030000210002JAbeginbmatrix3100030000210002endbmatrixJA3000130000200012PPPcorrespondingtothisbasischangeis1100100021013110ieP1APJAbeginbmatrix1100100021013110endbmatrixieP1APJA1123101100010010ieP1APJACheckingthroughpythonP1100100021013110Pbeginbmatrix1100100021013110endbmatrixP1123101100010010A4100120073207612Abeginbmatrix4100120073207612endbmatrixA4177123600210002P1AP3100030000210002P1APbeginbmatrix3100030000210002endbmatrixP1AP3000130000200012"}]';
obj = JSON.parse(SearchResult);

function check() {
    return false;
}

function maxfor(arr) {
    var len = arr.length;
    var max = -Infinity;
    while (len--) {
        if (arr[len] > max) {
            max = arr[len];
        }
    }
    return max;
}

let input = document.getElementById('input')
let result = document.getElementById('resultlist')
let button = document.getElementById('searchbutton')

input.addEventListener("focus", e => {
    result.id = 'active'
    result.style.overflow = 'hidden'
    result.style.padding = '0px'
    result.style.color="#7fffaa"
    result.style.fontFamily="Poppins"
    result.style.fontWeight="900"
    result.style.fontSize="100"
})
input.addEventListener("blur", e => {
    result.id = 'resultlist'
    result.style.overflow = 'hidden'
    result.style.padding = '0'
})

function searchtext() {
    result.innerHTML = '';


    // 标题搜索
    resultcount = 0;
    resultstr = '';
    var resulttitlecache = new Array()
    for (i = 0; i < obj.length; i++) {
        if (obj[i]['title'].includes(input.value) == true) {
            resulttitlecache.unshift(obj[i]['title'])
            resultcount++;
        }
    }

    // 标题搜索结果展示
    if (resultcount !== 0 && resultcount !== obj.length) {
        for (i = 0; i < resulttitlecache.length; i++) {
            for (j = 0; j < obj.length; j++) {
                if (obj[j]['title'] == resulttitlecache[i]) {
                    titlesearchresult = '<a href="https://ferneychen.github.io/OS_Jupiter/Docs/' + obj[j]["path"] + '" style="color:#f0e68c;font-size:18px">' + obj[j]['title'].replace(new RegExp(input.value, 'g'), '<mark style="background-color:transparent;color:#00ffff">' + input.value + '</mark>')+'<br>'
                    resultstr = titlesearchresult + resultstr
                }
            }
            result.innerHTML = resultstr;
        }
    }

    // 正文搜索
    var resulttextcache = new Array()
    for (i = 0; i < obj.length; i++) {
        if (obj[i]['text'].includes(input.value) == true) {
            resulttextcache.unshift(obj[i]['text'])
            resultcount++;
        }
    }

    // 正文搜索结果计数
    var targetname = new Array()
    var targetscore = new Array()
    if (resulttextcache.length !== 0 && input.value !== '') {
        for (i = 0; i < resulttextcache.length; i++) {
            for (j = 0; j < obj.length; j++) {
                if (obj[j]['text'] == resulttextcache[i]) {
                    targetname.unshift(obj[j]['title'])
                    targetscore.unshift(obj[j]['text'].match(RegExp(input.value, 'gim')).length)
                }
            }
        }
    }

    //排序相关选项
    var targetscorecache = targetscore.concat([]);
    var resultfortext = '';
    var textsearchresult = ''
    targetscorecache.sort(function (a, b) {
        return b - a
    })
    for (i = 0; i < targetscorecache.length; i++) {
        for (j = 0; j < targetscore.length; j++) {
            if (targetscorecache[i] == targetscore[j]) {
                console.log('文章排序:' + targetname[j])
                for (k = 0; k < obj.length; k++) {
                    if (obj[k]['title'] == targetname[j]) {
                        // 确认选区
                        textorder = obj[k]['text'].indexOf(input.value) - 15;
                        while (textorder < 0) {
                            textorder++
                        }

                        resultfortext = '<a href="https://ferneychen.github.io/OS_Jupiter/Docs/' + obj[k]["path"] + '" style="color:#f0e68c;font-size:18px">' + obj[k]['title'] + '</a>&nbsp;-&nbsp;' + targetscorecache[i] + '&nbsp;Matched in contents'/* + obj[k]['text'].substring(textorder, textorder + 100).replace(new RegExp(input.value, 'g'), '<mark style="background-color:transparent;color:#00ffff">' + input.value + '</mark>')*/+'<br>'
                        textsearchresult = textsearchresult + resultfortext;
                    }
                }
            }
        }
    }

    if (resultcount !== obj.length) {
        if (resultcount == 0) {
            result.innerHTML ='<p>Sorry, we did not find any documents..</p>'
        }
    }

    result.innerHTML = result.innerHTML + textsearchresult.substring(0, textsearchresult.length - 4) 
}
